<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Profiling - SC1</title>
    <meta property="og:title" content="Profiling - SC1">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="Profiling in R is fairly straightforward using the profvis package, which builds upon base R’s Rprof functionality.
library(profvis) This is a statistical profiler: it operates by regularly (e.g. &amp;hellip;">
      <meta property="og:description" content="Profiling in R is fairly straightforward using the profvis package, which builds upon base R’s Rprof functionality.
library(profvis) This is a statistical profiler: it operates by regularly (e.g. &amp;hellip;">
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/sc1/css/style.css" />
    <link rel="stylesheet" href="/sc1/css/fonts.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arvo">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Marcellus">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">

<link rel="stylesheet" href="/sc1/css/custom.css" />

<link rel="icon" href="/sc1/favicon.ico" type="image/x-icon" />























<nav class="breadcrumbs">
    
        <a href="https://awllee.github.io/sc1/">home / </a>
    
        <a href="https://awllee.github.io/sc1/profile-debug/">profile-debug / </a>
    
        <a href="https://awllee.github.io/sc1/profile-debug/profile/">profile / </a>
    
</nav>

  </head>

  
  <body class="sc1">
    <header class="masthead">
      <h1><a href="/sc1/">SC1</a></h1>

<p class="tagline">Statistical Computing 1</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/sc1/">Home</a></li>
  
  <li><a href="/sc1/intro-r/">Intro to R</a></li>
  
  <li><a href="/sc1/reproducibility/">Reproducibility</a></li>
  
  <li><a href="/sc1/common-r/">Common R</a></li>
  
  <li><a href="/sc1/tidyverse/">Tidyverse</a></li>
  
  <li><a href="/sc1/packages/">Packages</a></li>
  
  <li><a href="/sc1/functional-oo/">Functional / OO</a></li>
  
  <li><a href="/sc1/profile-debug/">Performance / Bugs</a></li>
  
  <li><a href="/sc1/matrices/">Matrices</a></li>
  
  <li><a href="/sc1/optimization/">Optimization</a></li>
  
  <li><a href="/sc1/integration/">Integration</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Profiling</h1>

<h3>
</h3>
<hr>


      </header>




<link href="/sc1/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/sc1/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>
<script src="/sc1/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/sc1/rmarkdown-libs/jquery/jquery.min.js"></script>
<script src="/sc1/rmarkdown-libs/d3/d3.min.js"></script>
<link href="/sc1/rmarkdown-libs/profvis/profvis.css" rel="stylesheet" />
<script src="/sc1/rmarkdown-libs/profvis/profvis.js"></script>
<script src="/sc1/rmarkdown-libs/profvis/scroll.js"></script>
<link href="/sc1/rmarkdown-libs/highlight/textmate.css" rel="stylesheet" />
<script src="/sc1/rmarkdown-libs/highlight/highlight.js"></script>
<script src="/sc1/rmarkdown-libs/profvis-binding/profvis.js"></script>

<div id="TOC">
<ul>
<li><a href="#updating-a-list-of-primes">Updating a list of primes</a></li>
<li><a href="#the-sieve-of-eratosthenes">The Sieve of Eratosthenes</a></li>
<li><a href="#comments">Comments</a></li>
</ul>
</div>

<p><a href="https://en.wikipedia.org/wiki/Profiling_(computer_programming)">Profiling</a> in R is fairly straightforward using the <a href="https://rstudio.github.io/profvis/"><code>profvis</code></a> package, which builds upon base R’s <code>Rprof</code> functionality.</p>
<pre class="r"><code>library(profvis)</code></pre>
<p>This is a <em>statistical profiler</em>: it operates by regularly (e.g. every few milliseconds) using operating system interrupts to determine what code is being executed. This enables one to build a picture of where the computation is spending most of its time, and is essentially an application of the Monte Carlo method. Although the results are not deterministic, the profiling operation adds very little overhead to the computation.</p>
<p>Statistical profilers can be viewed in contrast to <em>instrumenting profilers</em> of various flavours, which often involve incrementing counters whenever certain events occur. This often involves instrumenting existing code by adding instructions to increment the counters either manually or automatically. For example, incrementing a counter whenever a function is called. Instrumenting profilers can provide very accurate results, but can add substantial overhead to the computation. These tools can be important not only for understanding performance, but also for checking the validity and robustness of code: for example, <a href="https://en.wikipedia.org/wiki/Valgrind">Valgrind</a> is often used in C code to detect memory leaks and memory reference errors.</p>
<p>We consider here profiling various R functions for generating an array of all primes less than or equal to some number.</p>
<div id="updating-a-list-of-primes" class="section level2">
<h2>Updating a list of primes</h2>
<p>A straightforward approach to generating all prime numbers less than some number <span class="math inline">\(N\)</span> is to iterate through the numbers <span class="math inline">\(3,\ldots,N\)</span> and add the current number to the list of primes if there is no divisor of that number in the current list of primes.</p>
<p>In the following, we profile 3 variants of this approach. The first variant is a very inefficient implementation.</p>
<pre class="r"><code>source(&quot;generate-primes-1.R&quot;, keep.source=TRUE)
profvis(generate.primes.upto.1(10000))</code></pre>
<div id="htmlwidget-1" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"message":{"prof":{"time":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,3,4,4,4,4,4,4,5,6,6,6,6,6,6,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,12,12,12,12,12,13,13,13,13,13,14,14,14,14,14,15,15,15,15,15,16,16,16,16,16,17,17,17,17,17,18,19,20,20,20,20,20,21,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,27,28,29,29,29,29,29,30,30,30,30,30,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,33,34,35,36,36,37,37,37,37,37,38,39,40,40,40,40,40,41,42,42,42,42,42,43,43,43,43,43,43,44,45,46,46,46,46,46,47,47,47,47,47,48,49,49,49,49,49,50,50,50,50,50,50,51,52,52,53,53,53,53,53,54,54,54,54,54,55,55,55,55,55,56,56,57,57,57,57,57,58,59,59,59,59,59,60,61,61,61,61,61,62,63,63,63,63,63,63,64,65,65,65,65,65,66,66,66,66,66,67,68,69,69,69,69,69,70,70,70,70,70,71,71,71,71,71,72,73,74,74,74,74,74,74,75,75,75,75,75,76,77,77,77,77,77,78,78,78,78,78,79,80,81,81,81,81,81,82,82,82,82,82,83,84,84,84,84,84,85,85,85,85,85,86,86,86,86,86,87,87,87,87,87,88,88,88,88,88,89,90,90,90,90,90,91,91,91,91,91,91,92,93,93,93,93,93,93,94,94,94,94,94,95,96,96,96,96,96,97,98,99,100,100,100,100,100,101,102,102,102,102,102,103,104,104,104,104,104,104,105,105,105,105,105,106,106,106,106,106,107,107,107,107,107,108,109,109,109,109,109,110,111,111,111,111,111,112,113,114,115,116,117,117,117,117,117,118,119,119,120,121,121,121,121,121,121,122,123,123,123,123,123,123,124,125,125,125,125,125,126,126,126,126,126,127,127,127,127,127,128,128,129,130,130,130,130,130,131,131,131,131,131,132,132,132,132,132,133,134,134,134,134,134,134,135,135,135,135,135,136,136,136,136,136,137,138,139,139,139,139,139],"depth":[25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,5,4,3,2,1,1,6,5,4,3,2,1,1,6,5,4,3,2,1,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,1,5,4,3,2,1,6,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,6,5,4,3,2,1,5,4,3,2,1,1,1,2,1,5,4,3,2,1,1,1,5,4,3,2,1,1,5,4,3,2,1,6,5,4,3,2,1,1,1,5,4,3,2,1,5,4,3,2,1,1,5,4,3,2,1,6,5,4,3,2,1,1,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,2,1,5,4,3,2,1,1,5,4,3,2,1,1,5,4,3,2,1,1,6,5,4,3,2,1,1,5,4,3,2,1,5,4,3,2,1,1,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,1,6,5,4,3,2,1,5,4,3,2,1,1,5,4,3,2,1,5,4,3,2,1,1,1,5,4,3,2,1,5,4,3,2,1,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,5,4,3,2,1,6,5,4,3,2,1,1,6,5,4,3,2,1,5,4,3,2,1,1,5,4,3,2,1,1,1,1,5,4,3,2,1,1,5,4,3,2,1,1,6,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,5,4,3,2,1,1,5,4,3,2,1,1,1,1,1,1,5,4,3,2,1,1,2,1,1,6,5,4,3,2,1,1,6,5,4,3,2,1,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,2,1,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,6,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,1,5,4,3,2,1],"label":["cmp","h","tryInline","cmpCall","cmp","h","tryInline","cmpCall","cmp","cmpForBody","h","tryInline","cmpCall","cmp","h","tryInline","cmpCall","cmp","genCode","cmpfun","compiler:::tryCmpfun","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","for (j in primes) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","for (j in primes) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","local","for (j in primes) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","for (j in primes) {","eval","eval","eval.parent","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","for (j in primes) {","eval","eval","eval.parent","local","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","local","for (j in primes) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local"],"filenum":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,1,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null],"linenum":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,5,null,null,null,null,6,null,null,null,null,5,null,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,6,null,6,null,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,6,null,5,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,6,null,null,null,null,null,6,null,null,null,null,null,5,null,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,5,null,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,null,null,5,null,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,null],"memalloc":[10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.3878173828125,10.9383239746094,10.9383239746094,10.9383239746094,10.9383239746094,10.9383239746094,11.7903442382812,9.06596374511719,9.06596374511719,9.06596374511719,9.06596374511719,9.06596374511719,9.06596374511719,8.07156372070312,8.72845458984375,8.72845458984375,8.72845458984375,8.72845458984375,8.72845458984375,8.72845458984375,7.91472625732422,8.60606384277344,8.60606384277344,8.60606384277344,8.60606384277344,8.60606384277344,7.7698974609375,7.7698974609375,7.7698974609375,7.7698974609375,7.7698974609375,8.47285461425781,8.47285461425781,8.47285461425781,8.47285461425781,8.47285461425781,7.63576507568359,8.34815979003906,8.34815979003906,8.34815979003906,8.34815979003906,8.34815979003906,7.49372863769531,7.49372863769531,7.49372863769531,7.49372863769531,7.49372863769531,8.20341491699219,8.20341491699219,8.20341491699219,8.20341491699219,8.20341491699219,7.36333465576172,7.36333465576172,7.36333465576172,7.36333465576172,7.36333465576172,8.04997253417969,8.04997253417969,8.04997253417969,8.04997253417969,8.04997253417969,7.20771026611328,7.20771026611328,7.20771026611328,7.20771026611328,7.20771026611328,7.89142608642578,7.07135772705078,7.7681884765625,7.7681884765625,7.7681884765625,7.7681884765625,7.7681884765625,8.72621154785156,8.72621154785156,8.72621154785156,8.72621154785156,8.72621154785156,8.72621154785156,7.6279296875,7.6279296875,7.6279296875,7.6279296875,7.6279296875,8.66558837890625,8.66558837890625,8.66558837890625,8.66558837890625,8.66558837890625,7.48703765869141,7.48703765869141,7.48703765869141,7.48703765869141,7.48703765869141,8.52590942382812,8.52590942382812,8.52590942382812,8.52590942382812,8.52590942382812,7.34939575195312,7.34939575195312,7.34939575195312,7.34939575195312,7.34939575195312,8.40085601806641,7.21596527099609,8.26345825195312,8.26345825195312,8.26345825195312,8.26345825195312,8.26345825195312,7.09747314453125,7.09747314453125,7.09747314453125,7.09747314453125,7.09747314453125,8.14126586914062,8.14126586914062,8.14126586914062,8.14126586914062,8.14126586914062,8.73827362060547,8.73827362060547,8.73827362060547,8.73827362060547,8.73827362060547,8.73827362060547,8.0062255859375,8.0062255859375,8.0062255859375,8.0062255859375,8.0062255859375,8.69768524169922,7.88969421386719,8.57656097412109,8.57656097412109,7.76015472412109,7.76015472412109,7.76015472412109,7.76015472412109,7.76015472412109,8.43701934814453,7.62887573242188,8.33757019042969,8.33757019042969,8.33757019042969,8.33757019042969,8.33757019042969,7.49297332763672,8.17992401123047,8.17992401123047,8.17992401123047,8.17992401123047,8.17992401123047,8.75539398193359,8.75539398193359,8.75539398193359,8.75539398193359,8.75539398193359,8.75539398193359,7.48476409912109,8.46495056152344,7.23929595947266,7.23929595947266,7.23929595947266,7.23929595947266,7.23929595947266,8.29229736328125,8.29229736328125,8.29229736328125,8.29229736328125,8.29229736328125,7.09316253662109,8.12028503417969,8.12028503417969,8.12028503417969,8.12028503417969,8.12028503417969,8.70565032958984,8.70565032958984,8.70565032958984,8.70565032958984,8.70565032958984,8.70565032958984,7.96488189697266,8.63625335693359,8.63625335693359,7.81089019775391,7.81089019775391,7.81089019775391,7.81089019775391,7.81089019775391,8.51640319824219,8.51640319824219,8.51640319824219,8.51640319824219,8.51640319824219,7.63437652587891,7.63437652587891,7.63437652587891,7.63437652587891,7.63437652587891,8.30547332763672,8.30547332763672,7.49954223632812,7.49954223632812,7.49954223632812,7.49954223632812,7.49954223632812,8.18442535400391,7.34786224365234,7.34786224365234,7.34786224365234,7.34786224365234,7.34786224365234,8.04362487792969,7.17989349365234,7.17989349365234,7.17989349365234,7.17989349365234,7.17989349365234,7.89051055908203,8.75181579589844,8.75181579589844,8.75181579589844,8.75181579589844,8.75181579589844,8.75181579589844,7.71901702880859,8.73200225830078,8.73200225830078,8.73200225830078,8.73200225830078,8.73200225830078,7.58695220947266,7.58695220947266,7.58695220947266,7.58695220947266,7.58695220947266,8.60680389404297,7.45411682128906,8.49510955810547,8.49510955810547,8.49510955810547,8.49510955810547,8.49510955810547,7.31096649169922,7.31096649169922,7.31096649169922,7.31096649169922,7.31096649169922,8.36530303955078,8.36530303955078,8.36530303955078,8.36530303955078,8.36530303955078,7.1763916015625,8.22221374511719,8.7855224609375,8.7855224609375,8.7855224609375,8.7855224609375,8.7855224609375,8.7855224609375,8.08100891113281,8.08100891113281,8.08100891113281,8.08100891113281,8.08100891113281,8.7542724609375,7.9547119140625,7.9547119140625,7.9547119140625,7.9547119140625,7.9547119140625,8.65761566162109,8.65761566162109,8.65761566162109,8.65761566162109,8.65761566162109,7.81768035888672,8.52690887451172,7.72601318359375,7.72601318359375,7.72601318359375,7.72601318359375,7.72601318359375,8.41002655029297,8.41002655029297,8.41002655029297,8.41002655029297,8.41002655029297,7.64539337158203,8.3564453125,8.3564453125,8.3564453125,8.3564453125,8.3564453125,7.52056884765625,7.52056884765625,7.52056884765625,7.52056884765625,7.52056884765625,8.20839691162109,8.20839691162109,8.20839691162109,8.20839691162109,8.20839691162109,7.3812255859375,7.3812255859375,7.3812255859375,7.3812255859375,7.3812255859375,8.07054138183594,8.07054138183594,8.07054138183594,8.07054138183594,8.07054138183594,7.12418365478516,7.82547760009766,7.82547760009766,7.82547760009766,7.82547760009766,7.82547760009766,8.70020294189453,8.70020294189453,8.70020294189453,8.70020294189453,8.70020294189453,8.70020294189453,7.71494293212891,8.69336700439453,8.69336700439453,8.69336700439453,8.69336700439453,8.69336700439453,8.69336700439453,7.58895111083984,7.58895111083984,7.58895111083984,7.58895111083984,7.58895111083984,8.63664245605469,7.44495391845703,7.44495391845703,7.44495391845703,7.44495391845703,7.44495391845703,8.48475646972656,7.32769012451172,8.39424133300781,7.23196411132812,7.23196411132812,7.23196411132812,7.23196411132812,7.23196411132812,8.27264404296875,7.12136840820312,7.12136840820312,7.12136840820312,7.12136840820312,7.12136840820312,8.17890930175781,8.73623657226562,8.73623657226562,8.73623657226562,8.73623657226562,8.73623657226562,8.73623657226562,8.06705474853516,8.06705474853516,8.06705474853516,8.06705474853516,8.06705474853516,8.75228881835938,8.75228881835938,8.75228881835938,8.75228881835938,8.75228881835938,7.95088958740234,7.95088958740234,7.95088958740234,7.95088958740234,7.95088958740234,8.63956451416016,7.82298278808594,7.82298278808594,7.82298278808594,7.82298278808594,7.82298278808594,8.52104187011719,7.70988464355469,7.70988464355469,7.70988464355469,7.70988464355469,7.70988464355469,8.42226409912109,7.57289886474609,8.27552795410156,7.46234893798828,8.16631317138672,7.34378051757812,7.34378051757812,7.34378051757812,7.34378051757812,7.34378051757812,8.03047180175781,7.23602294921875,7.23602294921875,7.93870544433594,8.81794738769531,8.81794738769531,8.81794738769531,8.81794738769531,8.81794738769531,8.81794738769531,7.81837463378906,8.83624267578125,8.83624267578125,8.83624267578125,8.83624267578125,8.83624267578125,8.83624267578125,7.68372344970703,8.73119354248047,8.73119354248047,8.73119354248047,8.73119354248047,8.73119354248047,7.57840728759766,7.57840728759766,7.57840728759766,7.57840728759766,7.57840728759766,8.63482666015625,8.63482666015625,8.63482666015625,8.63482666015625,8.63482666015625,7.44868469238281,7.44868469238281,8.48355865478516,7.34098815917969,7.34098815917969,7.34098815917969,7.34098815917969,7.34098815917969,8.40779876708984,8.40779876708984,8.40779876708984,8.40779876708984,8.40779876708984,7.23397064208984,7.23397064208984,7.23397064208984,7.23397064208984,7.23397064208984,8.27787780761719,8.8670654296875,8.8670654296875,8.8670654296875,8.8670654296875,8.8670654296875,8.8670654296875,7.84701538085938,7.84701538085938,7.84701538085938,7.84701538085938,7.84701538085938,8.51632690429688,8.51632690429688,8.51632690429688,8.51632690429688,8.51632690429688,7.67066192626953,8.37907409667969,7.56048583984375,7.56048583984375,7.56048583984375,7.56048583984375,7.56048583984375],"meminc":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.550506591796875,0,0,0,0,0.852020263671875,-2.72438049316406,0,0,0,0,0,-0.994400024414062,0.656890869140625,0,0,0,0,0,-0.813728332519531,0.691337585449219,0,0,0,0,-0.836166381835938,0,0,0,0,0.702957153320312,0,0,0,0,-0.837089538574219,0.712394714355469,0,0,0,0,-0.85443115234375,0,0,0,0,0.709686279296875,0,0,0,0,-0.840080261230469,0,0,0,0,0.686637878417969,0,0,0,0,-0.842262268066406,0,0,0,0,0.6837158203125,-0.820068359375,0.696830749511719,0,0,0,0,0.958023071289062,0,0,0,0,0,-1.09828186035156,0,0,0,0,1.03765869140625,0,0,0,0,-1.17855072021484,0,0,0,0,1.03887176513672,0,0,0,0,-1.176513671875,0,0,0,0,1.05146026611328,-1.18489074707031,1.04749298095703,0,0,0,0,-1.16598510742188,0,0,0,0,1.04379272460938,0,0,0,0,0.597007751464844,0,0,0,0,0,-0.732048034667969,0,0,0,0,0.691459655761719,-0.807991027832031,0.686866760253906,0,-0.81640625,0,0,0,0,0.676864624023438,-0.808143615722656,0.708694458007812,0,0,0,0,-0.844596862792969,0.68695068359375,0,0,0,0,0.575469970703125,0,0,0,0,0,-1.2706298828125,0.980186462402344,-1.22565460205078,0,0,0,0,1.05300140380859,0,0,0,0,-1.19913482666016,1.02712249755859,0,0,0,0,0.585365295410156,0,0,0,0,0,-0.740768432617188,0.671371459960938,0,-0.825363159179688,0,0,0,0,0.705513000488281,0,0,0,0,-0.882026672363281,0,0,0,0,0.671096801757812,0,-0.805931091308594,0,0,0,0,0.684883117675781,-0.836563110351562,0,0,0,0,0.695762634277344,-0.863731384277344,0,0,0,0,0.710617065429688,0.861305236816406,0,0,0,0,0,-1.03279876708984,1.01298522949219,0,0,0,0,-1.14505004882812,0,0,0,0,1.01985168457031,-1.15268707275391,1.04099273681641,0,0,0,0,-1.18414306640625,0,0,0,0,1.05433654785156,0,0,0,0,-1.18891143798828,1.04582214355469,0.563308715820312,0,0,0,0,0,-0.704513549804688,0,0,0,0,0.673263549804688,-0.799560546875,0,0,0,0,0.702903747558594,0,0,0,0,-0.839935302734375,0.709228515625,-0.800895690917969,0,0,0,0,0.684013366699219,0,0,0,0,-0.764633178710938,0.711051940917969,0,0,0,0,-0.83587646484375,0,0,0,0,0.687828063964844,0,0,0,0,-0.827171325683594,0,0,0,0,0.689315795898438,0,0,0,0,-0.946357727050781,0.7012939453125,0,0,0,0,0.874725341796875,0,0,0,0,0,-0.985260009765625,0.978424072265625,0,0,0,0,0,-1.10441589355469,0,0,0,0,1.04769134521484,-1.19168853759766,0,0,0,0,1.03980255126953,-1.15706634521484,1.06655120849609,-1.16227722167969,0,0,0,0,1.04067993164062,-1.15127563476562,0,0,0,0,1.05754089355469,0.557327270507812,0,0,0,0,0,-0.669181823730469,0,0,0,0,0.685234069824219,0,0,0,0,-0.801399230957031,0,0,0,0,0.688674926757812,-0.816581726074219,0,0,0,0,0.69805908203125,-0.8111572265625,0,0,0,0,0.712379455566406,-0.849365234375,0.702629089355469,-0.813179016113281,0.703964233398438,-0.822532653808594,0,0,0,0,0.686691284179688,-0.794448852539062,0,0.702682495117188,0.879241943359375,0,0,0,0,0,-0.99957275390625,1.01786804199219,0,0,0,0,0,-1.15251922607422,1.04747009277344,0,0,0,0,-1.15278625488281,0,0,0,0,1.05641937255859,0,0,0,0,-1.18614196777344,0,1.03487396240234,-1.14257049560547,0,0,0,0,1.06681060791016,0,0,0,0,-1.173828125,0,0,0,0,1.04390716552734,0.589187622070312,0,0,0,0,0,-1.02005004882812,0,0,0,0,0.6693115234375,0,0,0,0,-0.845664978027344,0.708412170410156,-0.818588256835938,0,0,0,0],"filename":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,"generate-primes-1.R",null,null,null,null,null,null,"generate-primes-1.R",null,null,null,null]},"interval":10,"files":[{"filename":"generate-primes-1.R","content":"generate.primes.upto.1 <- function(N) {\n  primes <- 2\n  for (i in 3:N) {\n    found.divisor <- FALSE\n    for (j in primes) {\n      if (i %% j == 0) {\n        found.divisor <- TRUE\n      }\n    }\n    if (!found.divisor) primes <- c(primes,i)\n  }\n  return(primes)\n}\n","normpath":"/home/travis/build/awllee/sc1/content/profile-debug/generate-primes-1.R"}],"prof_output":"/tmp/RtmpoIh5dQ/file45204f730836.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
<p>We see from the <code>profvis</code> results that most of the time is spent in line 6 performing the integer modulus operation. If we look at the code more closely, we can see that it is possible to eliminate some of these operations by breaking the loop over primes as soon as one divisor is found.</p>
<pre class="r"><code>source(&quot;generate-primes-2.R&quot;, keep.source=TRUE)
profvis(generate.primes.upto.2(10000))</code></pre>
<div id="htmlwidget-2" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"message":{"prof":{"time":[1,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,11,12,13,14,15,16,16,16,16,16],"depth":[1,1,5,4,3,2,1,5,4,3,2,1,6,5,4,3,2,1,5,4,3,2,1,6,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,1,1,1,1,1,1,5,4,3,2,1],"label":["local","local","if (i %% j == 0) {","eval","eval","eval.parent","local","for (j in primes) {","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","if (i %% j == 0) {","eval","eval","eval.parent","local","local","local","local","local","local","local","if (i %% j == 0) {","eval","eval","eval.parent","local"],"filenum":[null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null],"linenum":[null,null,6,null,null,null,null,5,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,null,null,null,null,6,null,null,null,null],"memalloc":[9.35647583007812,8.17550659179688,9.71975708007812,9.71975708007812,9.71975708007812,9.71975708007812,9.71975708007812,8.40978240966797,8.40978240966797,8.40978240966797,8.40978240966797,8.40978240966797,9.94448852539062,9.94448852539062,9.94448852539062,9.94448852539062,9.94448852539062,9.94448852539062,8.65763092041016,8.65763092041016,8.65763092041016,8.65763092041016,8.65763092041016,9.95497894287109,9.95497894287109,9.95497894287109,9.95497894287109,9.95497894287109,9.95497894287109,8.89028930664062,8.89028930664062,8.89028930664062,8.89028930664062,8.89028930664062,8.10738372802734,8.10738372802734,8.10738372802734,8.10738372802734,8.10738372802734,9.13864135742188,8.34603881835938,9.36928558349609,8.59156036376953,9.61721038818359,8.84325408935547,9.87663269042969,9.87663269042969,9.87663269042969,9.87663269042969,9.87663269042969],"meminc":[0,-1.18096923828125,1.54425048828125,0,0,0,0,-1.30997467041016,0,0,0,0,1.53470611572266,0,0,0,0,0,-1.28685760498047,0,0,0,0,1.29734802246094,0,0,0,0,0,-1.06468963623047,0,0,0,0,-0.782905578613281,0,0,0,0,1.03125762939453,-0.7926025390625,1.02324676513672,-0.777725219726562,1.02565002441406,-0.773956298828125,1.03337860107422,0,0,0,0],"filename":[null,null,"generate-primes-2.R",null,null,null,null,"generate-primes-2.R",null,null,null,null,null,"generate-primes-2.R",null,null,null,null,"generate-primes-2.R",null,null,null,null,null,"generate-primes-2.R",null,null,null,null,"generate-primes-2.R",null,null,null,null,"generate-primes-2.R",null,null,null,null,null,null,null,null,null,null,"generate-primes-2.R",null,null,null,null]},"interval":10,"files":[{"filename":"generate-primes-2.R","content":"generate.primes.upto.2 <- function(N) {\n  primes <- 2\n  for (i in 3:N) {\n    found.divisor <- FALSE\n    for (j in primes) {\n      if (i %% j == 0) {\n        found.divisor <- TRUE\n        break\n      }\n    }\n    if (!found.divisor) primes <- c(primes,i)\n  }\n  return(primes)\n}\n","normpath":"/home/travis/build/awllee/sc1/content/profile-debug/generate-primes-2.R"}],"prof_output":"/tmp/RtmpoIh5dQ/file45206bd93cdf.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
<p>This has dramatically reduced the running time of the algorithm, by a factor of about 10. Although the function is fairly short, we may feel that the code is not easy to read. In particular, the overall idea of the algorithm can be lost in the implementation details. So we can consider the same algorithm, but where we call a helper function called <code>any.divisors</code> instead.</p>
<pre class="r"><code>source(&quot;generate-primes-3.R&quot;, keep.source=TRUE)
profvis(generate.primes.upto.3(10000))</code></pre>
<div id="htmlwidget-3" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"message":{"prof":{"time":[1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,6,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,16],"depth":[1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,1,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,7,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,1],"label":["local","for (j in ps) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","local","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","<GC>","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","if (i %% j == 0) {","generate.primes.upto.3","eval","eval","eval.parent","local","local"],"filenum":[null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null],"linenum":[null,2,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,3,null,null,null,null,null,null],"memalloc":[8.78901672363281,9.43315887451172,9.43315887451172,9.43315887451172,9.43315887451172,9.43315887451172,9.43315887451172,8.72026824951172,8.72026824951172,8.72026824951172,8.72026824951172,8.72026824951172,8.72026824951172,9.41764068603516,9.41764068603516,9.41764068603516,9.41764068603516,9.41764068603516,9.41764068603516,8.54845428466797,9.24495697021484,8.35895538330078,8.35895538330078,8.35895538330078,8.35895538330078,8.35895538330078,8.35895538330078,9.0498046875,9.0498046875,9.0498046875,9.0498046875,9.0498046875,9.0498046875,8.17095947265625,8.17095947265625,8.17095947265625,8.17095947265625,8.17095947265625,8.17095947265625,8.8697509765625,8.8697509765625,8.8697509765625,8.8697509765625,8.8697509765625,8.8697509765625,9.79899597167969,9.79899597167969,9.79899597167969,9.79899597167969,9.79899597167969,9.79899597167969,9.79899597167969,8.66865539550781,8.66865539550781,8.66865539550781,8.66865539550781,8.66865539550781,8.66865539550781,9.70784759521484,9.70784759521484,9.70784759521484,9.70784759521484,9.70784759521484,9.70784759521484,8.49488830566406,8.49488830566406,8.49488830566406,8.49488830566406,8.49488830566406,8.49488830566406,9.54374694824219,9.54374694824219,9.54374694824219,9.54374694824219,9.54374694824219,9.54374694824219,8.30872344970703],"meminc":[0,0.644142150878906,0,0,0,0,0,-0.712890625,0,0,0,0,0,0.697372436523438,0,0,0,0,0,-0.869186401367188,0.696502685546875,-0.886001586914062,0,0,0,0,0,0.690849304199219,0,0,0,0,0,-0.87884521484375,0,0,0,0,0,0.69879150390625,0,0,0,0,0,0.929244995117188,0,0,0,0,0,0,-1.13034057617188,0,0,0,0,0,1.03919219970703,0,0,0,0,0,-1.21295928955078,0,0,0,0,0,1.04885864257812,0,0,0,0,0,-1.23502349853516],"filename":[null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,"generate-primes-3.R",null,null,null,null,null,null]},"interval":10,"files":[{"filename":"generate-primes-3.R","content":"any.divisors <- function(i, ps) {\n  for (j in ps) {\n    if (i %% j == 0) {\n      return(TRUE)\n    }\n  }\n  return(FALSE)\n}\n\ngenerate.primes.upto.3 <- function(N) {\n  primes <- 2\n  for (i in 3:N) {\n    if (!any.divisors(i, primes)) {\n      primes <- c(primes,i)\n    }\n  }\n  return(primes)\n}\n","normpath":"/home/travis/build/awllee/sc1/content/profile-debug/generate-primes-3.R"}],"prof_output":"/tmp/RtmpoIh5dQ/file4520285326b4.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
<p>It seems reasonable to say that the third version of the algorithm is easier to understand. Moreover, there is little to no performance penalty.</p>
</div>
<div id="the-sieve-of-eratosthenes" class="section level2">
<h2>The Sieve of Eratosthenes</h2>
<p>A more computationally efficient approach is the <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">Sieve of Eratosthenes</a>. In this approach, one does not check whether each number is prime by checking divisors. Instead, one starts with a list of numbers from <span class="math inline">\(1\)</span> to <span class="math inline">\(N\)</span> and successively marks all multiples of each prime, in order, as composite. To identify the next prime after <span class="math inline">\(2\)</span> for marking multiples, one simply needs to find the next number not marked composite.</p>
<p>This approach is so much faster, that we consider finding all primes up to <span class="math inline">\(1000000\)</span> instead of up to <span class="math inline">\(10000\)</span>.</p>
<pre class="r"><code>source(&quot;sieve-1.R&quot;, keep.source=TRUE)
profvis(sieve.1(1000000))</code></pre>
<div id="htmlwidget-4" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"message":{"prof":{"time":[1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,14,14,14,14,14,15,15,15,15,15,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,19,19,19,19,19,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25],"depth":[5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1],"label":["s <- s + i","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","s <- s + i","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","for (i in 2:N) {","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","if (candidates[i]) {","eval","eval","eval.parent","local"],"filenum":[1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null],"linenum":[10,null,null,null,null,8,null,null,null,null,9,null,null,null,null,8,null,null,null,null,9,null,null,null,null,10,null,null,null,null,8,null,null,null,null,9,null,null,null,null,9,null,null,null,null,9,null,null,null,null,8,null,null,null,null,9,null,null,null,null,8,null,null,null,null,8,null,null,null,null,8,null,null,null,null,9,null,null,null,null,9,null,null,null,null,9,null,null,null,null,9,null,null,null,null,8,null,null,null,null,8,null,null,null,null,9,null,null,null,null,4,null,null,null,null,8,null,null,null,null,5,null,null,null,null],"memalloc":[12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398,12.0645370483398],"meminc":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"filename":["sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null,"sieve-1.R",null,null,null,null]},"interval":10,"files":[{"filename":"sieve-1.R","content":"sieve.1 <- function(N) {\n  candidates <- rep(TRUE,N)\n  candidates[1] <- FALSE\n  for (i in 2:N) {\n    if (candidates[i]) {\n      # i is prime\n      s <- i*2\n      while (s <= N) {\n        candidates[s] <- FALSE\n        s <- s + i\n      }\n    }\n  }\n  return((1:N)[candidates])\n}\n","normpath":"/home/travis/build/awllee/sc1/content/profile-debug/sieve-1.R"}],"prof_output":"/tmp/RtmpoIh5dQ/file45202519606e.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
<p>We see that most of the time is spent in lines 8–10, which correspond to marking <code>s</code> as composite and incrementing <code>s</code> by the current prime. We can remove some of these computations by noticing that if <span class="math inline">\(i\)</span> is prime then all multiples <span class="math inline">\(2i,3i,\ldots,(i-1)i\)</span> will already have been marked as composite. It follows that one can also stop “sieving” as soon as <span class="math inline">\(i &gt; \sqrt{N}\)</span>.</p>
<pre class="r"><code>source(&quot;sieve-2.R&quot;, keep.source=TRUE)
profvis(sieve.2(1000000))</code></pre>
<div id="htmlwidget-5" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"message":{"prof":{"time":[1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,14,14,14,14,14],"depth":[5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1],"label":["while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","s <- s + i","eval","eval","eval.parent","local","candidates[s] <- FALSE","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local","while (s <= N) {","eval","eval","eval.parent","local"],"filenum":[1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null,1,null,null,null,null],"linenum":[9,null,null,null,null,10,null,null,null,null,10,null,null,null,null,9,null,null,null,null,9,null,null,null,null,10,null,null,null,null,10,null,null,null,null,9,null,null,null,null,10,null,null,null,null,9,null,null,null,null,11,null,null,null,null,10,null,null,null,null,9,null,null,null,null,9,null,null,null,null],"memalloc":[12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281,12.0776672363281],"meminc":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"filename":["sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null,"sieve-2.R",null,null,null,null]},"interval":10,"files":[{"filename":"sieve-2.R","content":"sieve.2 <- function(N) {\n  candidates <- rep(TRUE,N)\n  candidates[1] <- FALSE\n  sqrt.N <- sqrt(N)\n  for (i in 2:sqrt.N) {\n    if (candidates[i]) {\n      # i is prime\n      s <- i*i\n      while (s <= N) {\n        candidates[s] <- FALSE\n        s <- s + i\n      }\n    }\n  }\n  return((1:N)[candidates])\n}\n","normpath":"/home/travis/build/awllee/sc1/content/profile-debug/sieve-2.R"}],"prof_output":"/tmp/RtmpoIh5dQ/file45204dfa7da1.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
<p>There appears to be a moderate improvement in performance for this size of problem. We notice that a substantial amount of time is spent in the <code>while</code> loop, which mainly involves incrementing <code>s</code> and flagging the corresponding number as composite. We can vectorize this computation and separate it cleanly from the rest of the algorithm, as follows.</p>
<pre class="r"><code>source(&quot;sieve-3.R&quot;, keep.source=TRUE)
profvis(sieve.3(1000000))</code></pre>
<div id="htmlwidget-6" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-6">{"x":{"message":{"prof":{"time":[1,1,1,1,1,1,1,2,3,3,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,6,6],"depth":[7,6,5,4,3,2,1,1,7,6,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,8,7,6,5,4,3,2,1],"label":["seq.default","get.multiples","sieve.3","eval","eval","eval.parent","local","local","seq.default","get.multiples","sieve.3","eval","eval","eval.parent","local","candidates[multiples] <- FALSE","eval","eval","eval.parent","local","candidates[multiples] <- FALSE","eval","eval","eval.parent","local","pmin","seq.default","get.multiples","sieve.3","eval","eval","eval.parent","local"],"filenum":[null,1,null,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,1,null,null,null,null,null,null,1,null,null,null,null,null],"linenum":[null,14,null,null,null,null,null,null,null,14,null,null,null,null,null,15,null,null,null,null,15,null,null,null,null,null,null,14,null,null,null,null,null],"memalloc":[21.6510848999023,21.6510848999023,21.6510848999023,21.6510848999023,21.6510848999023,21.6510848999023,21.6510848999023,23.63818359375,35.1519165039062,35.1519165039062,35.1519165039062,35.1519165039062,35.1519165039062,35.1519165039062,35.1519165039062,42.7330169677734,42.7330169677734,42.7330169677734,42.7330169677734,42.7330169677734,53.9560775756836,53.9560775756836,53.9560775756836,53.9560775756836,53.9560775756836,60.2477951049805,60.2477951049805,60.2477951049805,60.2477951049805,60.2477951049805,60.2477951049805,60.2477951049805,60.2477951049805],"meminc":[0,0,0,0,0,0,0,1.98709869384766,11.5137329101562,0,0,0,0,0,0,7.58110046386719,0,0,0,0,11.2230606079102,0,0,0,0,6.29171752929688,0,0,0,0,0,0,0],"filename":[null,"sieve-3.R",null,null,null,null,null,null,null,"sieve-3.R",null,null,null,null,null,"sieve-3.R",null,null,null,null,"sieve-3.R",null,null,null,null,null,null,"sieve-3.R",null,null,null,null,null]},"interval":10,"files":[{"filename":"sieve-3.R","content":"get.multiples <- function(i, N) {\n  n <- floor(N/i) - i\n  if (n <= 0) return(NULL)\n  multiples <- seq(i*i,(i+n)*i,i)\n  return(multiples)\n}\n\nsieve.3 <- function(N) {\n  candidates <- rep(TRUE,N)\n  candidates[1] <- FALSE\n  sqrt.N <- sqrt(N)\n  for (i in 2:sqrt.N) {\n    if (candidates[i]) {\n      multiples <- get.multiples(i, N)\n      candidates[multiples] <- FALSE\n    }\n  }\n  return((1:N)[candidates])\n}\n","normpath":"/home/travis/build/awllee/sc1/content/profile-debug/sieve-3.R"}],"prof_output":"/tmp/RtmpoIh5dQ/file452011157b24.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
<p>This gives another improvement to performance. It is worth noting that creating an array of multiples is faster than iterating through multiples in R, because the cost of allocating memory is negligible in comparison to the benefit of eliminating the loop. In a programming language such as C, the reverse is often true, as allocating memory is typically expensive in comparison to iteration once compiled into machine code.</p>
</div>
<div id="comments" class="section level2">
<h2>Comments</h2>
<p>Profiling in this scenario is already quite useful, as one can see which parts of the code are critical for performance. In larger applications, profiling is even more useful as one can quickly determine which functions are the most important from a performance perspective: if 1% of computation time is spent in a particular function, very little improvement can be derived by improving it, whereas if 99% of computation time is spent in a function one can conceivably improve performance very substantially by accelerating the implementation or improving the corresponding algorithm itself.</p>
<p>Profiling is also helpful for maintaining code readability and modularity: in some cases performance can be improved by sacrificing readability, or modularity of the code. Doing so can make sense if the code is critical to performance, but it makes little sense when the code is unimportant from a performance perspective.</p>
<p>Finally, when profiling code and trying to improve its performance, good testing tools are very useful for ensuring that any improvement in performance has not come at the cost of breaking existing functionality, including in rare, corner cases.</p>
</div>


  <footer>
  

<script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>


<script type="text/javascript">
var sc_project=12110974;
var sc_invisible=1;
var sc_security="9b171880";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12110974/0/9b171880/1/"
alt="Web Analytics"></a></div></noscript>








  


<p align=right>

<a href='https://github.com/awllee/sc1/blob/master/content/profile-debug/profile.Rmd'>View source</a>

|

<a href='https://github.com/awllee/sc1/edit/master/content/profile-debug/profile.Rmd'>Edit source</a>

</p>





<script src="https://utteranc.es/client.js"
        repo="awllee/sc1"
        issue-term="pathname"
        label="utterance"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>



  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">© 2020 <a href="https://sites.google.com/view/anthonylee">Anthony Lee</a>, <a href="http://www.bristol.ac.uk/maths/people/feng-yu/index.html">Feng Yu</a>, <a href="https://people.maths.bris.ac.uk/~tk18582/">Tobias Kley</a>, <a href="https://mfasiolo.github.io/">Matteo Fasiolo</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

